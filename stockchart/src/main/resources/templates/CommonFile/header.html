<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:attr="data-theme=${theme != null ? theme : 'light'}">
<head>
<style>
  /* ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
  #tickerInput {
    width: 400px;
    height: 400px; 
    padding: 8px;
    font-size: 16px;
  }

  /* ìë™ì™„ì„± ëª©ë¡ ìŠ¤íƒ€ì¼ */
  #autocompleteList {
    border: 1px solid #ccc;
    border-top: none;
    max-height: 150px;
    overflow-y: auto;
    position: absolute;
    width: 300px;
    background-color: #fff;
    z-index: 1000;
  }

  /* ëª©ë¡ ì•„ì´í…œ ìŠ¤íƒ€ì¼ */
  .autocomplete-item {
    padding: 8px;
    cursor: pointer;
  }

  .autocomplete-item:hover {
    background-color: #f0f0f0;
  }
  
  :root {
  --bg-color: #ffffff;
  --text-color: #000000;
}

[data-theme='dark'] {
  --bg-color: #121212;
  --text-color: #e0e0e0;
}

body {
  background-color: var(--bg-color);
  color: var(--text-color);
  transition: background-color 0.3s, color 0.3s;
}

</style>

	<link href="/css/header.css" rel="stylesheet" type="text/css">
</head>
<body>
<header class="header"style="width:2000px; height:130px;">
    <div class="container">
        <div class="row header-top"> 
         <div class="col logo">
 		<a href="/api/stock-data/main">
        <img src="/images/logo2.png" alt="Logo" class="logo-img" width="150" height="auto"/>
		</a>
</div>
           
    <div class="col search-bar" style="display:flex; align-items:center;">
    <form id="stockSearchForm" action="/stocks" method="get" >
    <input type="text" id="tickerInput" name="ticker" placeholder="í‹°ì»¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."  style="width:480px">
    <button type="submit">Search</button>
	</form>
    </div>
    
                <div class="dark-mode-toggle" style="display:flex;justify-content: space-around">
   <button id="darkModeButton">ë‹¤í¬ ëª¨ë“œ on off</button>
  
   <button id="theme-toggle">ğŸŒ™ ë‹¤í¬ëª¨ë“œ</button>

  
</div>
    
            <div class="col login">
            <form id="loginbutton" action="/api/stock-data/login" method="get">
  	  <button type="submit">ë¡œê·¸ì¸</button>
  	  </form>
	</div>
        </div>
        <nav class="menu" style="display: flex;justify-content: space-around;">
            <ul>
                <li><a href="/api/stock-data/enquiry">ì´ë¡ í˜ì´ì§€</a></li>
                <li><a href="/api/stock-data/sector">íˆíŠ¸ë§µ</a></li>
                <li><a href="/api/stock-data/explain">ë¬¸ì˜í•˜ê¸°</a></li>
                <li><a href="/api/stock-data/recommend">ì¶”ì²œí˜ì´ì§€</a></li>
               
            </ul>
            
        </nav>
    </div>
</header>

<script th:inline="javascript">

const input = document.getElementById('tickerInput');
const autocompleteList = document.getElementById('autocompleteList');

	input.addEventListener('input', async (e) => {
    const query = e.target.value;

    // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ëª©ë¡ ìˆ¨ê¹€
    if (!query) {
        autocompleteList.innerHTML = '';
        return;
    }

    // ì„œë²„ì— ê²€ìƒ‰ ìš”ì²­
    const response = await fetch(`/api/suggestions?ticker=${query}`);
    const suggestions = await response.json();

    // ìë™ì™„ì„± ëª©ë¡ í‘œì‹œ
    autocompleteList.innerHTML = suggestions
        .map(item => `<div class="autocomplete-item" onclick="selectSuggestion('${item}')">${item}</div>`)
        .join('');
	});

	// ìë™ì™„ì„± í•­ëª© ì„ íƒ ì²˜ë¦¬
	function selectSuggestion(value) {
    input.value = value;
    autocompleteList.innerHTML = ''; // ëª©ë¡ ì´ˆê¸°í™”
	}
	
	function autocomplete(value2) {	
	input.value2 = value2;
	autocompleteList.innerHTML = '';
	}
	
	let userTheme = /*[[${theme}]]*/ 'light';
	
</script>

<script th:src="@{/js/theme-toggle.js}">

const toggleButton = document.getElementById('theme-toggle');
const html = document.documentElement;

toggleButton.addEventListener('click', () => {
  const currentTheme = html.getAttribute('data-theme');
  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
  html.setAttribute('data-theme', newTheme);
  toggleButton.textContent = newTheme === 'light' ? 'ğŸŒ™ ë‹¤í¬ëª¨ë“œ' : 'â˜€ï¸ ë¼ì´íŠ¸ëª¨ë“œ';
  localStorage.setItem('theme', newTheme);
});

// í˜ì´ì§€ ë¡œë“œì‹œ
window.addEventListener('DOMContentLoaded', () => {
  // localStorage ìš°ì„ , ì—†ìœ¼ë©´ ì„œë²„ì—ì„œ ì£¼ì…ëœ userTheme ì‚¬ìš©
  const savedTheme = localStorage.getItem('theme') || (typeof userTheme !== 'undefined' ? userTheme : 'light');
  html.setAttribute('data-theme', savedTheme);
  toggleButton.textContent = savedTheme === 'light' ? 'ğŸŒ™ ë‹¤í¬ëª¨ë“œ' : 'â˜€ï¸ ë¼ì´íŠ¸ëª¨ë“œ';
});

</script>
</body>
</html>
