<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<style>
  /* 검색창 스타일 */
  #tickerInput {
    width: 300px;
    padding: 8px;
    font-size: 16px;
  }

  /* 자동완성 목록 스타일 */
  #autocompleteList {
    border: 1px solid #ccc;
    border-top: none;
    max-height: 150px;
    overflow-y: auto;
    position: absolute;
    width: 300px;
    background-color: #fff;
    z-index: 1000;
  }

  /* 목록 아이템 스타일 */
  .autocomplete-item {
    padding: 8px;
    cursor: pointer;
  }

  .autocomplete-item:hover {
    background-color: #f0f0f0;
  }
</style>

	<link href="/css/header.css" rel="stylesheet" type="text/css">
</head>
<body>
<header class="header">
    <div class="container">
        <div class="row header-top"> 
         <div class="col logo">
 		<a href="/api/stock-data/main">
        <img src="/images/logo2.png" alt="Logo" class="logo-img" width="120" height="auto"/>
		</a>
</div>
           
    <div class="col search-bar">
    <form id="stockSearchForm" action="/stocks" method="get" style="display: flex; align-items: center;" >
    <input type="text" id="tickerInput" name="ticker" placeholder="티커를 입력해주세요">
    <button type="submit">Search</button>
	</form>
    </div>
    
            <div class="col login">
            <form id="loginbutton" action="/api/stock-data/login" method="get">
  	  <button type="submit">로그인</button>
  	  </form>
	</div>
        </div>
        <nav class="menu">
            <ul>
                <li><a href="#">홈</a></li>
                <li><a href="#">서비스</a></li>
                <li><a href="#">추천</a></li>
                <li><a href="#">고객센터</a></li>
            </ul>
            <div class="dark-mode-toggle">
  <button id="darkModeButton">다크 모드</button>
</div>
        </nav>
    </div>
</header>

<script th:inline="javascript">

const input = document.getElementById('tickerInput');
const autocompleteList = document.getElementById('autocompleteList');

	input.addEventListener('input', async (e) => {
    const query = e.target.value;

    // 검색어가 없으면 목록 숨김
    if (!query) {
        autocompleteList.innerHTML = '';
        return;
    }

    // 서버에 검색 요청
    const response = await fetch(`/api/suggestions?ticker=${query}`);
    const suggestions = await response.json();

    // 자동완성 목록 표시
    autocompleteList.innerHTML = suggestions
        .map(item => `<div class="autocomplete-item" onclick="selectSuggestion('${item}')">${item}</div>`)
        .join('');
	});

	// 자동완성 항목 선택 처리
	function selectSuggestion(value) {
    input.value = value;
    autocompleteList.innerHTML = ''; // 목록 초기화
	}
</script>
</body>
</html>
